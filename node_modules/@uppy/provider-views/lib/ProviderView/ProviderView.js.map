{"version":3,"names":["h","PQueue","getSafeFileId","AuthView","Header","Browser","LoaderView","CloseWrapper","View","packageJson","getOrigin","location","origin","getRegex","value","RegExp","undefined","isOriginAllowed","allowedOrigin","patterns","Array","isArray","map","some","pattern","test","formatBreadcrumbs","breadcrumbs","slice","directory","name","join","prependPath","path","component","_abortController","_classPrivateFieldLooseKey","_withAbort","_list","_listFilesAndFolders","_recursivelyListAllFiles","ProviderView","constructor","plugin","opts","Object","defineProperty","_recursivelyListAllFiles2","_listFilesAndFolders2","_list2","_withAbort2","writable","defaultOptions","viewType","showTitles","showFilter","showBreadcrumbs","loadAllFiles","filterQuery","bind","clearFilter","getFolder","getNextFolder","logout","handleAuth","handleScroll","donePicking","render","setPluginState","authenticated","files","folders","filterInput","isSearchVisible","currentSelection","tearDown","requestPath","setLoading","_classPrivateFieldLooseBase","signal","lastCheckbox","getPluginState","index","findIndex","dir","nextPagePath","newFiles","newFolders","concat","uppy","i18n","numFiles","length","err","handleError","folder","res","provider","ok","revoked","message","title","url","manual_revoke_url","info","newState","input","ensurePreAuth","authState","btoa","JSON","stringify","clientVersion","VERSION","link","authUrl","state","uppyVersions","authWindow","window","open","handleToken","e","source","log","companionAllowedHosts","data","parse","error","token","close","removeEventListener","setAuthToken","preFirstRender","addEventListener","event","shouldHandleScroll","isHandlingScroll","combinedFiles","combinedFolders","messages","selectedItem","withRelDirPath","newItem","relDirPath","absDirPath","replace","isFolder","isEmpty","numNewFiles","queue","concurrency","onFiles","newFile","tagFile","getTagFile","id","checkIfFileAlreadyExists","push","onIdle","smart_count","addFiles","file","forEach","clearSelection","viewOptions","_this","didFirstRender","targetViewOptions","loading","isChecked","toggleCheckbox","recordShiftKeyPress","filterItems","hasInput","headerProps","pluginIcon","icon","username","browserProps","showSearchFilter","search","clearSearch","searchTerm","searchOnInput","searchInputLabel","clearSearchLabel","noResultsLabel","done","cancel","cancelPicking","headerComponent","uppyFiles","getFiles","validateRestrictions","arguments","onUnmount","pluginName","i18nArray","op","_classPrivateFieldLoo","abort","abortController","AbortController","cancelRequest","on","off","_ref","items","list","item","_ref2","_ref3","curPath","filter","promises","add","Promise","all","version"],"sources":["ProviderView.jsx"],"sourcesContent":["import { h } from 'preact'\n// eslint-disable-next-line import/no-unresolved\nimport PQueue from 'p-queue'\n\nimport { getSafeFileId } from '@uppy/utils/lib/generateFileID'\n\nimport AuthView from './AuthView.jsx'\nimport Header from './Header.jsx'\nimport Browser from '../Browser.jsx'\nimport LoaderView from '../Loader.jsx'\nimport CloseWrapper from '../CloseWrapper.js'\nimport View from '../View.js'\n\nimport packageJson from '../../package.json'\n\nfunction getOrigin () {\n  // eslint-disable-next-line no-restricted-globals\n  return location.origin\n}\n\nfunction getRegex (value) {\n  if (typeof value === 'string') {\n    return new RegExp(`^${value}$`)\n  } if (value instanceof RegExp) {\n    return value\n  }\n  return undefined\n}\nfunction isOriginAllowed (origin, allowedOrigin) {\n  const patterns = Array.isArray(allowedOrigin) ? allowedOrigin.map(getRegex) : [getRegex(allowedOrigin)]\n  return patterns\n    .some((pattern) => pattern?.test(origin) || pattern?.test(`${origin}/`)) // allowing for trailing '/'\n}\n\nfunction formatBreadcrumbs (breadcrumbs) {\n  return breadcrumbs.slice(1).map((directory) => directory.name).join('/')\n}\n\nfunction prependPath (path, component) {\n  if (!path) return component\n  return `${path}/${component}`\n}\n\n/**\n * Class to easily generate generic views for Provider plugins\n */\nexport default class ProviderView extends View {\n  static VERSION = packageJson.version\n\n  /**\n   * @param {object} plugin instance of the plugin\n   * @param {object} opts\n   */\n  constructor (plugin, opts) {\n    super(plugin, opts)\n    // set default options\n    const defaultOptions = {\n      viewType: 'list',\n      showTitles: true,\n      showFilter: true,\n      showBreadcrumbs: true,\n      loadAllFiles: false,\n    }\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    // Logic\n    this.filterQuery = this.filterQuery.bind(this)\n    this.clearFilter = this.clearFilter.bind(this)\n    this.getFolder = this.getFolder.bind(this)\n    this.getNextFolder = this.getNextFolder.bind(this)\n    this.logout = this.logout.bind(this)\n    this.handleAuth = this.handleAuth.bind(this)\n    this.handleScroll = this.handleScroll.bind(this)\n    this.donePicking = this.donePicking.bind(this)\n\n    // Visual\n    this.render = this.render.bind(this)\n\n    // Set default state for the plugin\n    this.plugin.setPluginState({\n      authenticated: false,\n      files: [],\n      folders: [],\n      breadcrumbs: [],\n      filterInput: '',\n      isSearchVisible: false,\n      currentSelection: [],\n    })\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  tearDown () {\n    // Nothing.\n  }\n\n  #abortController\n\n  async #withAbort (op) {\n    // prevent multiple requests in parallel from causing race conditions\n    this.#abortController?.abort()\n    const abortController = new AbortController()\n    this.#abortController = abortController\n    const cancelRequest = () => {\n      abortController.abort()\n      this.clearSelection()\n    }\n    try {\n      this.plugin.uppy.on('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.on('cancel-all', cancelRequest)\n\n      await op(abortController.signal)\n    } finally {\n      this.plugin.uppy.off('dashboard:close-panel', cancelRequest)\n      this.plugin.uppy.off('cancel-all', cancelRequest)\n      this.#abortController = undefined\n    }\n  }\n\n  async #list ({ requestPath, absDirPath, signal }) {\n    const { username, nextPagePath, items } = await this.provider.list(requestPath, { signal })\n    this.username = username || this.username\n\n    return {\n      items: items.map((item) => ({\n        ...item,\n        absDirPath,\n      })),\n      nextPagePath,\n    }\n  }\n\n  async #listFilesAndFolders ({ breadcrumbs, signal }) {\n    const absDirPath = formatBreadcrumbs(breadcrumbs)\n\n    const { items, nextPagePath } = await this.#list({ requestPath: this.nextPagePath, absDirPath, signal })\n\n    this.nextPagePath = nextPagePath\n\n    const files = []\n    const folders = []\n\n    items.forEach((item) => {\n      if (item.isFolder) {\n        folders.push(item)\n      } else {\n        files.push(item)\n      }\n    })\n\n    return { files, folders }\n  }\n\n  /**\n   * Select a folder based on its id: fetches the folder and then updates state with its contents\n   * TODO rename to something better like selectFolder or navigateToFolder (breaking change?)\n   *\n   * @param  {string} requestPath\n   * the path we need to use when sending list request to companion (for some providers it's different from ID)\n   * @param  {string} name used in the UI and to build the absDirPath\n   * @returns {Promise}   Folders/files in folder\n   */\n  async getFolder (requestPath, name) {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        this.lastCheckbox = undefined\n\n        let { breadcrumbs } = this.plugin.getPluginState()\n\n        const index = breadcrumbs.findIndex((dir) => requestPath === dir.requestPath)\n\n        if (index !== -1) {\n          // means we navigated back to a known directory (already in the stack), so cut the stack off there\n          breadcrumbs = breadcrumbs.slice(0, index + 1)\n        } else {\n          // we have navigated into a new (unknown) folder, add it to the stack\n          breadcrumbs = [...breadcrumbs, { requestPath, name }]\n        }\n\n        this.nextPagePath = requestPath\n        let files = []\n        let folders = []\n        do {\n          const { files: newFiles, folders: newFolders } = await this.#listFilesAndFolders({\n            breadcrumbs, signal,\n          })\n\n          files = files.concat(newFiles)\n          folders = folders.concat(newFolders)\n\n          this.setLoading(this.plugin.uppy.i18n('loadedXFiles', { numFiles: files.length + folders.length }))\n        } while (\n          this.opts.loadAllFiles && this.nextPagePath\n        )\n\n        this.plugin.setPluginState({ folders, files, breadcrumbs, filterInput: '' })\n      })\n    } catch (err) {\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  /**\n   * Fetches new folder\n   *\n   * @param  {object} folder\n   */\n  getNextFolder (folder) {\n    this.getFolder(folder.requestPath, folder.name)\n    this.lastCheckbox = undefined\n  }\n\n  /**\n   * Removes session token on client side.\n   */\n  async logout () {\n    try {\n      await this.#withAbort(async (signal) => {\n        const res = await this.provider.logout({ signal })\n        if (res.ok) {\n          if (!res.revoked) {\n            const message = this.plugin.uppy.i18n('companionUnauthorizeHint', {\n              provider: this.plugin.title,\n              url: res.manual_revoke_url,\n            })\n            this.plugin.uppy.info(message, 'info', 7000)\n          }\n\n          const newState = {\n            authenticated: false,\n            files: [],\n            folders: [],\n            breadcrumbs: [],\n            filterInput: '',\n          }\n          this.plugin.setPluginState(newState)\n        }\n      })\n    } catch (err) {\n      this.handleError(err)\n    }\n  }\n\n  filterQuery (input) {\n    this.plugin.setPluginState({ filterInput: input })\n  }\n\n  clearFilter () {\n    this.plugin.setPluginState({ filterInput: '' })\n  }\n\n  async handleAuth () {\n    await this.provider.ensurePreAuth()\n\n    const authState = btoa(JSON.stringify({ origin: getOrigin() }))\n    const clientVersion = `@uppy/provider-views=${ProviderView.VERSION}`\n    const link = this.provider.authUrl({ state: authState, uppyVersions: clientVersion })\n\n    const authWindow = window.open(link, '_blank')\n    const handleToken = (e) => {\n      if (e.source !== authWindow) {\n        this.plugin.uppy.log('rejecting event from unknown source')\n        return\n      }\n      if (!isOriginAllowed(e.origin, this.plugin.opts.companionAllowedHosts) || e.source !== authWindow) {\n        this.plugin.uppy.log(`rejecting event from ${e.origin} vs allowed pattern ${this.plugin.opts.companionAllowedHosts}`)\n      }\n\n      // Check if it's a string before doing the JSON.parse to maintain support\n      // for older Companion versions that used object references\n      const data = typeof e.data === 'string' ? JSON.parse(e.data) : e.data\n\n      if (data.error) {\n        this.plugin.uppy.log('auth aborted', 'warning')\n        const { uppy } = this.plugin\n        const message = uppy.i18n('authAborted')\n        uppy.info({ message }, 'warning', 5000)\n        return\n      }\n\n      if (!data.token) {\n        this.plugin.uppy.log('did not receive token from auth window', 'error')\n        return\n      }\n\n      authWindow.close()\n      window.removeEventListener('message', handleToken)\n      this.provider.setAuthToken(data.token)\n      this.preFirstRender()\n    }\n    window.addEventListener('message', handleToken)\n  }\n\n  async handleScroll (event) {\n    if (this.shouldHandleScroll(event) && this.nextPagePath) {\n      this.isHandlingScroll = true\n\n      try {\n        await this.#withAbort(async (signal) => {\n          const { files, folders, breadcrumbs } = this.plugin.getPluginState()\n\n          const { files: newFiles, folders: newFolders } = await this.#listFilesAndFolders({\n            breadcrumbs, signal,\n          })\n\n          const combinedFiles = files.concat(newFiles)\n          const combinedFolders = folders.concat(newFolders)\n\n          this.plugin.setPluginState({ folders: combinedFolders, files: combinedFiles })\n        })\n      } catch (error) {\n        this.handleError(error)\n      } finally {\n        this.isHandlingScroll = false\n      }\n    }\n  }\n\n  async #recursivelyListAllFiles ({ requestPath, absDirPath, relDirPath, queue, onFiles, signal }) {\n    let curPath = requestPath\n\n    while (curPath) {\n      const res = await this.#list({ requestPath: curPath, absDirPath, signal })\n      curPath = res.nextPagePath\n\n      const files = res.items.filter((item) => !item.isFolder)\n      const folders = res.items.filter((item) => item.isFolder)\n\n      onFiles(files)\n\n      // recursively queue call to self for each folder\n      const promises = folders.map(async (folder) => queue.add(async () => (\n        this.#recursivelyListAllFiles({\n          requestPath: folder.requestPath,\n          absDirPath: prependPath(absDirPath, folder.name),\n          relDirPath: prependPath(relDirPath, folder.name),\n          queue,\n          onFiles,\n          signal,\n        })\n      )))\n      await Promise.all(promises) // in case we get an error\n    }\n  }\n\n  async donePicking () {\n    this.setLoading(true)\n    try {\n      await this.#withAbort(async (signal) => {\n        const { currentSelection } = this.plugin.getPluginState()\n\n        const messages = []\n        const newFiles = []\n\n        for (const selectedItem of currentSelection) {\n          const { requestPath } = selectedItem\n\n          const withRelDirPath = (newItem) => ({\n            ...newItem,\n            // calculate the file's path relative to the user's selected item's path\n            // see https://github.com/transloadit/uppy/pull/4537#issuecomment-1614236655\n            relDirPath: newItem.absDirPath.replace(selectedItem.absDirPath, '').replace(/^\\//, ''),\n          })\n\n          if (selectedItem.isFolder) {\n            let isEmpty = true\n            let numNewFiles = 0\n\n            const queue = new PQueue({ concurrency: 6 })\n\n            const onFiles = (files) => {\n              for (const newFile of files) {\n                const tagFile = this.getTagFile(newFile)\n                const id = getSafeFileId(tagFile)\n                // If the same folder is added again, we don't want to send\n                // X amount of duplicate file notifications, we want to say\n                // the folder was already added. This checks if all files are duplicate,\n                // if that's the case, we don't add the files.\n                if (!this.plugin.uppy.checkIfFileAlreadyExists(id)) {\n                  newFiles.push(withRelDirPath(newFile))\n                  numNewFiles++\n                  this.setLoading(this.plugin.uppy.i18n('addedNumFiles', { numFiles: numNewFiles }))\n                }\n                isEmpty = false\n              }\n            }\n\n            await this.#recursivelyListAllFiles({\n              requestPath,\n              absDirPath: prependPath(selectedItem.absDirPath, selectedItem.name),\n              relDirPath: selectedItem.name,\n              queue,\n              onFiles,\n              signal,\n            })\n            await queue.onIdle()\n\n            let message\n            if (isEmpty) {\n              message = this.plugin.uppy.i18n('emptyFolderAdded')\n            } else if (numNewFiles === 0) {\n              message = this.plugin.uppy.i18n('folderAlreadyAdded', {\n                folder: selectedItem.name,\n              })\n            } else {\n              // TODO we don't really know at this point whether any files were actually added\n              // (only later after addFiles has been called) so we should probably rewrite this.\n              // Example: If all files fail to add due to restriction error, it will still say \"Added 100 files from folder\"\n              message = this.plugin.uppy.i18n('folderAdded', {\n                smart_count: numNewFiles, folder: selectedItem.name,\n              })\n            }\n\n            messages.push(message)\n          } else {\n            newFiles.push(withRelDirPath(selectedItem))\n          }\n        }\n\n        // Note: this.plugin.uppy.addFiles must be only run once we are done fetching all files,\n        // because it will cause the loading screen to disappear,\n        // and that will allow the user to start the upload, so we need to make sure we have\n        // finished all async operations before we add any file\n        // see https://github.com/transloadit/uppy/pull/4384\n        this.plugin.uppy.log('Adding remote provider files')\n        this.plugin.uppy.addFiles(newFiles.map((file) => this.getTagFile(file)))\n\n        this.plugin.setPluginState({ filterInput: '' })\n        messages.forEach(message => this.plugin.uppy.info(message))\n\n        this.clearSelection()\n      })\n    } catch (err) {\n      this.handleError(err)\n    } finally {\n      this.setLoading(false)\n    }\n  }\n\n  render (state, viewOptions = {}) {\n    const { authenticated, didFirstRender } = this.plugin.getPluginState()\n    const { i18n } = this.plugin.uppy\n\n    if (!didFirstRender) {\n      this.preFirstRender()\n    }\n\n    const targetViewOptions = { ...this.opts, ...viewOptions }\n    const { files, folders, filterInput, loading, currentSelection } = this.plugin.getPluginState()\n    const { isChecked, toggleCheckbox, recordShiftKeyPress, filterItems } = this\n    const hasInput = filterInput !== ''\n    const headerProps = {\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      getFolder: this.getFolder,\n      breadcrumbs: this.plugin.getPluginState().breadcrumbs,\n      pluginIcon: this.plugin.icon,\n      title: this.plugin.title,\n      logout: this.logout,\n      username: this.username,\n      i18n,\n    }\n\n    const browserProps = {\n      isChecked,\n      toggleCheckbox,\n      recordShiftKeyPress,\n      currentSelection,\n      files: hasInput ? filterItems(files) : files,\n      folders: hasInput ? filterItems(folders) : folders,\n      username: this.username,\n      getNextFolder: this.getNextFolder,\n      getFolder: this.getFolder,\n      loadAllFiles: this.opts.loadAllFiles,\n\n      // For SearchFilterInput component\n      showSearchFilter: targetViewOptions.showFilter,\n      search: this.filterQuery,\n      clearSearch: this.clearFilter,\n      searchTerm: filterInput,\n      searchOnInput: true,\n      searchInputLabel: i18n('filter'),\n      clearSearchLabel: i18n('resetFilter'),\n\n      noResultsLabel: i18n('noFilesFound'),\n      logout: this.logout,\n      handleScroll: this.handleScroll,\n      done: this.donePicking,\n      cancel: this.cancelPicking,\n      headerComponent: Header(headerProps),\n      title: this.plugin.title,\n      viewType: targetViewOptions.viewType,\n      showTitles: targetViewOptions.showTitles,\n      showBreadcrumbs: targetViewOptions.showBreadcrumbs,\n      pluginIcon: this.plugin.icon,\n      i18n: this.plugin.uppy.i18n,\n      uppyFiles: this.plugin.uppy.getFiles(),\n      validateRestrictions: (...args) => this.plugin.uppy.validateRestrictions(...args),\n    }\n\n    if (loading) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <LoaderView i18n={this.plugin.uppy.i18n} loading={loading} />\n        </CloseWrapper>\n      )\n    }\n\n    if (!authenticated) {\n      return (\n        <CloseWrapper onUnmount={this.clearSelection}>\n          <AuthView\n            pluginName={this.plugin.title}\n            pluginIcon={this.plugin.icon}\n            handleAuth={this.handleAuth}\n            i18n={this.plugin.uppy.i18n}\n            i18nArray={this.plugin.uppy.i18nArray}\n          />\n        </CloseWrapper>\n      )\n    }\n\n    return (\n      <CloseWrapper onUnmount={this.clearSelection}>\n        {/* eslint-disable-next-line react/jsx-props-no-spreading */}\n        <Browser {...browserProps} />\n      </CloseWrapper>\n    )\n  }\n}\n"],"mappings":"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"}